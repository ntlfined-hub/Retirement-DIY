<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Retirement Planner · Universe UI</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Fonts: Space Grotesk (หลัก), Kanit/Noto Sans Thai (สำรองภาษาไทย) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Kanit:wght@400;500;600&family=Noto+Sans+Thai:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#020617;
      --bg2:#0f172a;
      --bg3:rgba(99,102,241,.35);
      --card:rgba(10,14,26,.35);
      --border:rgba(255,255,255,.08);
      --ink:#e2e8f0;
      --muted:#94a3b8;
      --accent:#6366f1;
      --success:#10b981;
      --warn:#f97316;
    }
    body{
      font-family:'Space Grotesk','Kanit','Noto Sans Thai',system-ui,-apple-system,'Segoe UI',sans-serif;
      min-height:100vh;
      background:
        radial-gradient(circle at 20% 20%, rgba(99,102,241,.20), transparent 42%),
        radial-gradient(circle at 80% 12%, rgba(236,72,153,.12), transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(14,165,233,.15), transparent 55%),
        linear-gradient(180deg, #020617 0%, #0f172a 35%, #020617 100%);
      color:var(--ink);
      letter-spacing:-0.01em;
    }
    .glass-card{
      background:radial-gradient(circle at 10% 10%, rgba(255,255,255,.08), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.04);
      backdrop-filter:blur(18px);
      box-shadow:0 16px 55px rgba(15,23,42,.25);
      border-radius:1.25rem;
    }
    .input-premium{
      width:100%;
      background:rgba(2,6,23,.35);
      border:1px solid rgba(255,255,255,.05);
      border-radius:.9rem;
      padding:.6rem .75rem;
      font-size:.85rem;
      color:var(--ink);
    }
    .input-premium:focus{
      outline:none;
      border:1px solid rgba(99,102,241,.75);
      box-shadow:0 0 0 4px rgba(99,102,241,.12);
      background:rgba(2,6,23,.6);
    }
    .badge{
      background:rgba(15,118,255,.12);
      border:1px solid rgba(148,163,184,.20);
      border-radius:9999px;
      padding:.25rem .65rem;
      font-size:.65rem;
      letter-spacing:.04em;
    }
    .sticky-top{
      position:sticky; top:0; z-index:50;
      backdrop-filter:blur(22px);
      background:rgba(2,6,23,.3);
      border-bottom:1px solid rgba(148,163,184,.12);
    }
    @media (min-width:1024px){
      .layout{
        display:grid;
        grid-template-columns:350px minmax(0,1fr);
        gap:1.5rem;
        align-items:flex-start;
      }
    }
    .glow-outline{
      box-shadow:0 0 0 0 rgba(99,102,241,.7);
      animation:pulseGlow 3.5s ease-in-out infinite;
    }
    @keyframes pulseGlow{
      0%{box-shadow:0 0 0 0 rgba(99,102,241,.25);}
      50%{box-shadow:0 0 32px 0 rgba(99,102,241,.12);}
      100%{box-shadow:0 0 0 0 rgba(99,102,241,.0);}
    }

    /* ปุ่มโหลด */
    .btn-calc{
      position:relative;
      overflow:hidden;
      transition:transform .12s ease-out, box-shadow .12s ease-out;
    }
    .btn-calc:active{
      transform:translateY(1px);
    }
    .btn-calc.is-loading{
      pointer-events:none;
      opacity:.9;
      transform:translateY(1px) scale(.998);
    }
    .btn-calc .spinner{
      width:16px; height:16px;
      border:2px solid rgba(15,23,42,.15);
      border-top-color:#0f172a;
      border-radius:9999px;
      animation:spin .6s linear infinite;
    }
    @keyframes spin{
      to{ transform:rotate(360deg); }
    }
  </style>
</head>
<body class="pb-10">
  <!-- Header -->
  <header class="sticky-top">
    <div class="max-w-6xl mx-auto px-4 py-3 flex justify-between items-center gap-4">
      <div>
        <p class="text-[9.5px] uppercase tracking-[.3em] text-slate-400/70">FIN · RETIREMENT · UNIVERSE</p>
        <h1 class="text-lg md:text-xl font-semibold text-slate-50 leading-tight">ตัวช่วยวางแผนเกษียณล่วงหน้า</h1>
        <p class="text-[11px] text-slate-300/90">คำนวณแบบมีเงินเฟ้อ + เทียบออมปกติกับออมแบบลงทุน</p>
      </div>
      <div class="hidden sm:flex gap-2">
        <span class="badge">Inflation aware</span>
        <span class="badge">Invest compare</span>
        <span class="badge">Mobile friendly</span>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 layout gap-4 mt-4">
    <!-- LEFT -->
    <section class="space-y-4 mb-6">
      <!-- Basic data -->
      <div class="glass-card p-4 space-y-4">
        <div class="flex justify-between items-center gap-3">
          <div>
            <h2 class="text-sm font-semibold text-slate-50 flex items-center gap-2">
              ข้อมูลพื้นฐาน
              <span class="text-[9px] px-2 py-0.5 rounded-full bg-slate-50/5 border border-slate-50/10 text-slate-200/70">STEP 1</span>
            </h2>
            <p class="text-[10.5px] text-slate-400/90">ใส่ข้อมูลแค่ 4 ช่องก็เห็นเป้าหมายแล้ว</p>
          </div>
          <button id="btnDemo" class="text-[10.5px] px-3 py-1 rounded-lg bg-slate-50/10 border border-slate-50/10 text-slate-50 hover:bg-slate-50/20 transition">ใส่ตัวอย่าง</button>
        </div>

        <div class="space-y-2">
          <label class="text-[11px] text-slate-200/80">อายุปัจจุบัน</label>
          <input id="currentAge" type="number" min="18" max="70" value="30" class="input-premium" />
        </div>
        <div class="grid grid-cols-2 gap-2">
          <div class="space-y-2">
            <label class="text-[11px] text-slate-200/80">อายุที่ต้องการเกษียณ</label>
            <input id="retireAge" type="number" min="40" max="80" value="60" class="input-premium" />
          </div>
          <div class="space-y-2">
            <label class="text-[11px] text-slate-200/80">คาดว่าจะมีชีวิตถึงอายุ</label>
            <input id="lifeAge" type="number" min="70" max="100" value="85" class="input-premium" />
          </div>
        </div>
        <div class="space-y-2">
          <label class="text-[11px] text-slate-200/80">เงินที่ต้องการใช้/เดือนหลังเกษียณ (มูลค่าปัจจุบัน)</label>
          <input id="needPerMonth" type="number" min="3000" step="500" value="30000" class="input-premium" />
        </div>
      </div>

      <!-- Inflation -->
      <div class="glass-card p-4 space-y-3">
        <div class="flex items-center justify-between gap-3">
          <h2 class="text-sm font-semibold text-slate-50">เงินเฟ้อ (Inflation)</h2>
          <span class="text-[9.5px] text-right leading-tight text-slate-300/60 w-28">
            อิงไทยเป็นฐาน แล้วปรับเองได้
          </span>
        </div>
        <div class="space-y-1">
          <label class="text-[10.5px] text-slate-200/80 flex justify-between">
            <span>เงินเฟ้อเฉลี่ยต่อปี</span>
            <span id="inflationLabel" class="text-[10.5px] font-semibold text-slate-50">2.5%</span>
          </label>
          <input id="inflation" type="range" min="0.5" max="5" step="0.1" value="2.5" class="w-full accent-indigo-400" />
        </div>
        <p class="text-[9.5px] text-slate-300/60 leading-snug">
          * ระบบจะคูณเงินที่ต้องใช้/เดือนด้วย (1+infl)^ปีที่เหลือ เพื่อให้มูลค่าจริงตอนเกษียณ
        </p>
      </div>

      <!-- Investment -->
      <div class="glass-card p-4 space-y-3">
        <div class="flex items-center justify-between gap-3">
          <h2 class="text-sm font-semibold text-slate-50">การลงทุนระหว่างออม</h2>
          <span class="text-[9px] text-slate-300/60">0% = ออมเฉยๆ</span>
        </div>
        <div class="space-y-1">
          <label class="text-[10.5px] text-slate-200/80 flex justify-between">
            <span>ผลตอบแทนเฉลี่ยต่อปี</span>
            <span id="returnLabel" class="text-[10.5px] font-semibold text-slate-50">6.0%</span>
          </label>
          <input id="returnRate" type="range" min="0" max="12" step="0.1" value="6" class="w-full accent-indigo-400" />
        </div>
        <p class="text-[9.5px] text-slate-300/60 leading-snug">
          * ใช้สูตร Future Value of Annuity (ลงทุนทุกสิ้นเดือน) เพื่อลดภาระออม
        </p>
      </div>

      <button id="calcBtn" class="btn-calc w-full py-2.5 rounded-xl bg-slate-50 text-slate-950 text-sm font-medium hover:bg-slate-200/90 transition flex items-center justify-center gap-2">
        <span class="btn-text">คำนวณเป้าหมายเกษียณ</span>
      </button>
    </section>

    <!-- RIGHT -->
    <section class="space-y-4 mb-6">
      <!-- Summary cards -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
        <div class="glass-card p-3 space-y-1 glow-outline">
          <p class="text-[10.5px] text-slate-300/80 flex justify-between">
            เงินก้อนที่ต้องมีตอนอายุ <span id="summaryRetireAge" class="text-slate-50 font-semibold">60</span>
          </p>
          <p id="needLumpSum" class="text-2xl font-semibold text-slate-50 drop-shadow-sm tracking-tight">–</p>
          <p class="text-[9px] text-slate-300/60">คิดจากค่าครองชีพหลังเกษียณที่ถูกเงินเฟ้อแล้ว</p>
        </div>
        <div class="glass-card p-3 space-y-1">
          <p class="text-[10.5px] text-slate-300/80">ต้องเก็บ/เดือน (ไม่ลงทุน)</p>
          <p id="savePerMonthNoInv" class="text-2xl font-semibold text-slate-50 drop-shadow-sm tracking-tight">–</p>
          <p class="text-[9px] text-slate-300/60" id="yearsToSaveLabel">ตลอด … ปีจนถึงเกษียณ</p>
        </div>
        <div class="glass-card p-3 space-y-1">
          <p class="text-[10.5px] text-slate-300/80">ต้องเก็บ/เดือน (มีลงทุน)</p>
          <p id="savePerMonthInv" class="text-2xl font-semibold text-emerald-300 drop-shadow-sm tracking-tight">–</p>
          <p class="text-[9px] text-slate-300/60" id="invCompareLabel">ประหยัดจากการลงทุน –</p>
        </div>
      </div>

      <!-- Detail -->
      <div class="glass-card p-4 space-y-4">
        <div class="flex items-center justify-between gap-4">
          <h2 class="text-sm font-semibold text-slate-50 flex items-center gap-2">
            รายละเอียดการคำนวณ
            <span class="text-[9px] px-2 py-0.5 rounded-full bg-indigo-500/10 border border-indigo-300/15 text-indigo-100">Explainable</span>
          </h2>
          <span class="text-[9px] text-slate-300/40" id="lastCalcTime">ยังไม่ได้คำนวณ</span>
        </div>
        <div class="grid md:grid-cols-2 gap-4">
          <div class="space-y-3 border border-slate-50/5 rounded-xl p-3 bg-slate-950/10">
            <h3 class="text-[11px] font-semibold text-slate-50 uppercase tracking-wide">1) ค่าใช้จ่ายหลังเกษียณ</h3>
            <p class="text-[10px] text-slate-200/80 leading-snug">
              - ใช้เดือนละ: <span id="futureMonthlyNeed" class="font-semibold text-slate-50">–</span><br>
              - ใช้ปีละ: <span id="futureYearlyNeed" class="font-semibold text-slate-50">–</span><br>
              - ใช้ทั้งหมด (ตั้งแต่เกษียณถึงสิ้นอายุ): <span id="totalSpending" class="font-semibold text-slate-50">–</span>
            </p>
            <p class="text-[9px] text-slate-400/70">* ยังไม่คิดผลตอบแทนหลังเกษียณ เพื่อให้ conservative</p>
          </div>
          <div class="space-y-3 border border-slate-50/5 rounded-xl p-3 bg-slate-950/10">
            <h3 class="text-[11px] font-semibold text-slate-50 uppercase tracking-wide">2) เปรียบเทียบออมแบบต่างๆ</h3>
            <p class="text-[10px] text-slate-200/80 leading-snug">
              - เก็บแบบฝาก/ไม่ลงทุน: <span id="sumSaveNoInv" class="font-semibold text-slate-50">–</span><br>
              - เก็บแบบลงทุน: <span id="sumSaveInv" class="font-semibold text-slate-50">–</span><br>
              - เก็บน้อยลงได้: <span id="saveDiff" class="font-semibold text-emerald-300">–</span>
            </p>
            <p class="text-[9px] text-slate-400/70 leading-snug">* ถ้าผลตอบแทนต่ำมาก ตัวเลขสองฝั่งจะใกล้กัน</p>
          </div>
        </div>
      </div>

      <!-- Insight -->
      <div class="glass-card p-4 space-y-3">
        <h2 class="text-sm font-semibold text-slate-50 flex items-center gap-2">
          มุมมองเงินเฟ้อ & ไทยระยะยาว
          <span class="text-[9px] px-2 py-0.5 rounded-full bg-amber-500/10 text-amber-100 border border-amber-200/20">data-inspired</span>
        </h2>
        <p class="text-[10px] text-slate-200/70">
          ช่วง 2024–2025 เงินเฟ้อไทยค่อนข้างต่ำ แต่แผนเกษียณคือเรื่อง 10–30 ปีข้างหน้า จึงควรเผื่อ 2.5–3.0% ไว้ก่อน
          ระบบนี้เลยมี auto-adjust เล็กน้อยเมื่อระยะยาวมาก เพื่อกันการออมต่ำเกินไป
        </p>
      </div>
    </section>
  </main>

  <script>
    const el = id => document.getElementById(id);
    const currentAgeEl = el('currentAge');
    const retireAgeEl = el('retireAge');
    const lifeAgeEl = el('lifeAge');
    const needPerMonthEl = el('needPerMonth');
    const inflationEl = el('inflation');
    const inflationLabel = el('inflationLabel');
    const returnRateEl = el('returnRate');
    const returnLabel = el('returnLabel');
    const calcBtn = el('calcBtn');

    function formatMoney(num){
      if(isNaN(num)) return '–';
      return new Intl.NumberFormat('th-TH',{maximumFractionDigits:0}).format(Math.round(num)) + ' บาท';
    }
    function formatMoney2(num){
      if(isNaN(num)) return '–';
      return new Intl.NumberFormat('th-TH',{maximumFractionDigits:2}).format(num) + ' บาท';
    }

    function calc(){
      const currentAge = parseFloat(currentAgeEl.value);
      const retireAge = parseFloat(retireAgeEl.value);
      const lifeAge = parseFloat(lifeAgeEl.value);
      const needNowPerMonth = parseFloat(needPerMonthEl.value);
      const infl = parseFloat(inflationEl.value) / 100;
      const retRate = parseFloat(returnRateEl.value) / 100;

      const yearsToRetire = Math.max(retireAge - currentAge, 0);
      const yearsAfterRetire = Math.max(lifeAge - retireAge, 0);
      el('summaryRetireAge').textContent = retireAge;

      const futureMonthly = needNowPerMonth * Math.pow(1 + infl, yearsToRetire);
      const futureYearly = futureMonthly * 12;

      const lumpSum = futureMonthly * 12 * yearsAfterRetire;

      const monthsToSave = Math.max(yearsToRetire * 12, 1);
      const savePerMonthNoInv = lumpSum / monthsToSave;
      const savePerYearNoInv = savePerMonthNoInv * 12;

      let savePerMonthInv;
      if(retRate > 0){
        const r = retRate / 12;
        const factor = (Math.pow(1 + r, monthsToSave) - 1) / r;
        savePerMonthInv = lumpSum / factor;
      }else{
        savePerMonthInv = savePerMonthNoInv;
      }
      const savePerYearInv = savePerMonthInv * 12;
      const diffPerMonth = savePerMonthNoInv - savePerMonthInv;

      el('needLumpSum').textContent = formatMoney(lumpSum);
      el('savePerMonthNoInv').textContent = formatMoney(savePerMonthNoInv);
      el('savePerMonthInv').textContent = formatMoney(savePerMonthInv);
      el('yearsToSaveLabel').textContent = 'ตลอด ' + yearsToRetire + ' ปี (' + monthsToSave + ' เดือน)';
      el('invCompareLabel').textContent = diffPerMonth > 0 ? 'ประหยัดได้ ' + formatMoney(diffPerMonth) + '/เดือน' : 'ผลตอบแทนยังไม่ช่วยมาก';
      el('futureMonthlyNeed').textContent = formatMoney2(futureMonthly);
      el('futureYearlyNeed').textContent = formatMoney(futureYearly);
      el('totalSpending').textContent = formatMoney(lumpSum);
      el('sumSaveNoInv').textContent = formatMoney(savePerYearNoInv);
      el('sumSaveInv').textContent = formatMoney(savePerYearInv);
      el('saveDiff').textContent = formatMoney(diffPerMonth * 12);
      el('lastCalcTime').textContent = 'คำนวณล่าสุด: ' + new Date().toLocaleString('th-TH');

      const invCard = el('savePerMonthInv').parentElement;
      if(savePerMonthInv > savePerMonthNoInv){
        invCard.classList.add('ring-2','ring-rose-400/35');
      }else{
        invCard.classList.remove('ring-2','ring-rose-400/35');
      }
    }

    // ปุ่มกดคำนวณ + animation
    function handleCalcClick(){
      if(calcBtn.classList.contains('is-loading')) return;
      calcBtn.classList.add('is-loading');
      const oldText = calcBtn.querySelector('.btn-text').textContent;
      calcBtn.innerHTML = `
        <div class="spinner"></div>
        <span>กำลังคำนวณ...</span>
      `;
      // คำนวณเลย
      calc();
      // ปล่อยปุ่มให้กลับมาเดิมหน่อยนึงให้ user เห็น
      setTimeout(() => {
        calcBtn.classList.remove('is-loading');
        calcBtn.innerHTML = `<span class="btn-text">${oldText}</span>`;
      }, 400); // ปรับได้ 250-600ms
    }

    inflationEl.addEventListener('input', e => {
      inflationLabel.textContent = parseFloat(e.target.value).toFixed(1) + '%';
      calc();
    });
    returnRateEl.addEventListener('input', e => {
      returnLabel.textContent = parseFloat(e.target.value).toFixed(1) + '%';
      calc();
    });

    el('btnDemo').addEventListener('click', () => {
      currentAgeEl.value = 32;
      retireAgeEl.value = 58;
      lifeAgeEl.value = 85;
      needPerMonthEl.value = 40000;
      inflationEl.value = 2.8;
      inflationLabel.textContent = '2.8%';
      returnRateEl.value = 6.0;
      returnLabel.textContent = '6.0%';
      calc();
    });

    calcBtn.addEventListener('click', handleCalcClick);

    function autoAdjustInflation(){
      const yearsToRetire = Math.max(parseFloat(retireAgeEl.value) - parseFloat(currentAgeEl.value), 0);
      if(yearsToRetire >= 25){
        let now = parseFloat(inflationEl.value);
        const adjusted = Math.min(now + 0.4, 3.5);
        inflationEl.value = adjusted;
        inflationLabel.textContent = adjusted.toFixed(1) + '%';
      }
      calc();
    }
    currentAgeEl.addEventListener('change', autoAdjustInflation);
    retireAgeEl.addEventListener('change', autoAdjustInflation);

    // first run
    calc();
  </script>
</body>
</html>
