<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Retirement Studio</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Kanit:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --page:#f5f6fa;
      --surface:#ffffff;
      --ink:#121826;
      --muted:#6b7280;
      --line:#e5e7eb;
      --accent:#6366f1;
      --success:#0ea5e9;
      --danger:#ef4444;
    }
    body{
      font-family:'Space Grotesk','Kanit',system-ui,-apple-system,'Segoe UI',sans-serif;
      background:radial-gradient(circle at top, rgba(99,102,241,.06), transparent 42%), var(--page);
      min-height:100vh;
      color:var(--ink);
    }
    .app-shell{
      max-width:1180px;
      margin:0 auto;
      padding:1rem .9rem 3rem;
      display:flex;
      flex-direction:column;
      gap:1rem;
    }
    .card{
      background:var(--surface);
      border:1px solid rgba(15,23,42,.035);
      border-radius:1.25rem;
      box-shadow:0 16px 38px rgba(15,23,42,.03);
    }
    .input-premium{
      width:100%;
      background:#fff;
      border:1px solid #e2e8f0;
      border-radius:.9rem;
      padding:.55rem .75rem;
      font-size:.88rem;
      outline:none;
      transition:.1s;
    }
    .input-premium:focus{
      border:1px solid rgba(99,102,241,.94);
      box-shadow:0 0 0 3px rgba(99,102,241,.10);
    }
    .tag{
      font-size:.65rem;
      background:#eef2ff;
      color:#3730a3;
      border-radius:9999px;
      padding:.25rem .55rem;
      font-weight:500;
    }
    .btn-primary{
      background:linear-gradient(130deg,#1f2937 0%,#111827 100%);
      color:#fff;
      border:none;
      border-radius:.85rem;
      padding:.6rem .9rem;
      font-weight:600;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:.35rem;
      transition:.1s;
      box-shadow:0 12px 22px rgba(15,23,42,.12);
    }
    .btn-primary:hover{
      filter:brightness(1.04);
      transform:translateY(-1px);
    }
    .btn-primary.is-loading{
      pointer-events:none;
      opacity:.85;
    }
    .spinner{
      width:14px; height:14px;
      border:2px solid rgba(255,255,255,.25);
      border-top-color:#ffffff;
      border-radius:9999px;
      animation:spin .6s linear infinite;
    }
    @keyframes spin{ to{ transform:rotate(360deg); } }
    /* layout */
    .content-grid{
      display:grid;
      gap:1rem;
    }
    @media (min-width:1000px){
      .content-grid{
        grid-template-columns:340px minmax(0,1fr);
      }
    }
    .metric{
      display:flex;
      flex-direction:column;
      gap:.25rem;
      background:radial-gradient(circle at top, rgba(99,102,241,.04), transparent 50%), #ffffff;
      border:1px solid rgba(15,23,42,.02);
      border-radius:1rem;
      padding:.6rem .7rem .7rem;
    }
    .mono{ font-feature-settings:"tnum" 1,"lnum" 1; }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="bg-white/70 backdrop-blur sticky top-0 z-40 border-b border-slate-100">
    <div class="max-w-[1180px] mx-auto px-4 py-2.5 flex items-center justify-between gap-2">
      <div>
        <p class="text-[10px] uppercase tracking-[.2em] text-slate-400 mb-0.5">retirement studio</p>
        <h1 class="text-base md:text-lg font-semibold tracking-tight flex items-center gap-2">
          ตัวช่วยวางแผนเกษียณ
          <span class="px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-700 text-[10px] border border-emerald-100">Beta</span>
        </h1>
      </div>
      <div class="flex items-center gap-1 text-[11px] text-slate-500">
        <span class="hidden sm:inline text-slate-400">inflation-aware · invest compare</span>
      </div>
    </div>
  </header>

  <main class="app-shell">
    <!-- Top summary -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
      <div class="metric">
        <p class="text-[11px] text-slate-400 flex items-center gap-1">
          เงินก้อนที่ต้องมี
          <span class="tag" id="summaryRetireAge">60 ปี</span>
        </p>
        <p id="needLumpSum" class="text-2xl font-semibold tracking-tight mono">–</p>
        <p class="text-[10px] text-slate-400">คิดเงินเฟ้อแล้ว</p>
      </div>
      <div class="metric">
        <p class="text-[11px] text-slate-400">ออม/เดือน (ไม่ลงทุน)</p>
        <p id="savePerMonthNoInv" class="text-2xl font-semibold tracking-tight mono">–</p>
        <p id="yearsToSaveLabel" class="text-[10px] text-slate-400">–</p>
      </div>
      <div class="metric">
        <p class="text-[11px] text-slate-400 flex items-center gap-1">
          ออม/เดือน (ลงทุน)
          <span class="px-1.5 py-0.5 text-[10px] rounded-full bg-sky-50 text-sky-700 border border-sky-100">ลดภาระ</span>
        </p>
        <p id="savePerMonthInv" class="text-2xl font-semibold tracking-tight text-sky-600 mono">–</p>
        <p id="invCompareLabel" class="text-[10px] text-slate-400">–</p>
      </div>
    </div>

    <div class="content-grid">
      <!-- LEFT FORM -->
      <section class="card p-4 lg:p-5 space-y-4">
        <div>
          <p class="text-[11px] text-slate-500 mb-1">ข้อมูลของคุณ</p>
          <h2 class="text-sm font-semibold tracking-tight">ปรับค่าและลองคำนวณ</h2>
          <p class="text-[11px] text-slate-400">ระบบจะคำนวณแบบมีเงินเฟ้อ และเปรียบเทียบการลงทุนให้เลย</p>
        </div>

        <div class="space-y-2">
          <label class="text-[11px] text-slate-600">อายุปัจจุบัน</label>
          <input id="currentAge" type="number" min="18" max="70" value="30" class="input-premium" />
        </div>

        <div class="grid grid-cols-2 gap-3">
          <div class="space-y-2">
            <label class="text-[11px] text-slate-600">อายุที่ต้องการเกษียณ</label>
            <input id="retireAge" type="number" min="40" max="80" value="60" class="input-premium" />
          </div>
          <div class="space-y-2">
            <label class="text-[11px] text-slate-600">คาดว่าจะมีชีวิตถึงอายุ</label>
            <input id="lifeAge" type="number" min="70" max="100" value="85" class="input-premium" />
          </div>
        </div>

        <div class="space-y-2">
          <label class="text-[11px] text-slate-600">เงินที่ต้องการใช้/เดือนหลังเกษียณ (มูลค่าปัจจุบัน)</label>
          <input id="needPerMonth" type="number" min="3000" step="500" value="30000" class="input-premium" />
        </div>

        <div class="grid grid-cols-2 gap-3">
          <!-- inflation -->
          <div class="bg-slate-50 border border-slate-100 rounded-xl p-3 space-y-1">
            <div class="flex items-center justify-between gap-1">
              <p class="text-[11px] text-slate-700">เงินเฟ้อเฉลี่ย</p>
              <p id="inflationLabel" class="text-[11px] font-semibold text-indigo-600">2.5%</p>
            </div>
            <input id="inflation" type="range" min="0.5" max="5" step="0.1" value="2.5" class="w-full accent-indigo-500" />
            <p class="text-[10px] text-slate-400 leading-snug">
              ใช้ (1+infl)^ปี
            </p>
          </div>
          <!-- return -->
          <div class="bg-slate-50 border border-slate-100 rounded-xl p-3 space-y-1">
            <div class="flex items-center justify-between gap-1">
              <p class="text-[11px] text-slate-700">ผลตอบแทนเฉลี่ย</p>
              <p id="returnLabel" class="text-[11px] font-semibold text-indigo-600">6.0%</p>
            </div>
            <input id="returnRate" type="range" min="0" max="12" step="0.1" value="6" class="w-full accent-indigo-500" />
            <p class="text-[10px] text-slate-400 leading-snug">
              0% = ออมเฉยๆ
            </p>
          </div>
        </div>

        <div class="flex gap-2">
          <button id="calcBtn" class="btn-primary flex-1">
            <span class="btn-text">คำนวณเป้าหมายเกษียณ</span>
          </button>
          <button id="btnDemo" class="px-3 py-2 rounded-lg border border-slate-200 bg-white text-[11px] text-slate-700 hover:bg-slate-50">
            ใส่ตัวอย่าง
          </button>
        </div>
        <p id="lastCalcTime" class="text-[10px] text-slate-400">ยังไม่ได้คำนวณ</p>
      </section>

      <!-- RIGHT RESULT -->
      <section class="space-y-4">
        <!-- Assumption bar -->
        <div class="card p-3 flex flex-wrap items-center justify-between gap-2">
          <div class="flex gap-2 flex-wrap items-center">
            <span class="text-[11px] text-slate-500 uppercase tracking-wide">Assumptions</span>
            <span class="tag bg-white border border-indigo-50 text-indigo-600">คิดเงินเฟ้อถึงปีเกษียณ</span>
            <span class="tag bg-white border border-slate-100 text-slate-600">ไม่คิดผลตอบแทนหลังเกษียณ</span>
          </div>
          <p class="text-[10px] text-slate-400">ปรับเพิ่มเงินเฟ้อถ้าระยะเกิน 25 ปี</p>
        </div>

        <!-- Comparison -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-3">
          <div class="card p-4 space-y-2 border-l-4 border-slate-900/90">
            <p class="text-[11px] text-slate-500 uppercase tracking-wide">แบบไม่ลงทุน</p>
            <p class="text-sm text-slate-900">
              ต้องออมต่อปี: <span id="sumSaveNoInv" class="font-semibold mono">–</span>
            </p>
            <p class="text-[10px] text-slate-400">ออมเท่ากันทุกเดือนจนถึงเกษียณ</p>
          </div>
          <div class="card p-4 space-y-2 border-l-4 border-sky-400/90">
            <p class="text-[11px] text-slate-500 uppercase tracking-wide">แบบลงทุน</p>
            <p class="text-sm text-slate-900">
              ต้องออมต่อปี: <span id="sumSaveInv" class="font-semibold mono">–</span>
            </p>
            <p class="text-[10px] text-slate-400">ลงทุนทุกเดือน ใช้อนุกรมเงินงวด</p>
          </div>
        </div>

        <!-- Detail flow -->
        <div class="card p-4 space-y-3">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-[11px] text-slate-500 uppercase tracking-wide mb-1">รายละเอียดการคำนวณ</p>
              <h3 class="text-sm font-semibold tracking-tight">แยกเป็น 3 ขั้นตอน</h3>
            </div>
          </div>
          <div class="grid md:grid-cols-3 gap-3">
            <div class="bg-slate-50/80 rounded-lg p-3 space-y-1 border border-slate-100">
              <p class="text-[11px] text-slate-500">1. ค่าใช้จ่าย</p>
              <p class="text-[11.5px] text-slate-900">
                เดือนละ: <span id="futureMonthlyNeed" class="mono font-semibold">–</span>
              </p>
              <p class="text-[11.5px] text-slate-900">
                ปีละ: <span id="futureYearlyNeed" class="mono font-semibold">–</span>
              </p>
              <p class="text-[10px] text-slate-400">ถูกเงินเฟ้อแล้ว</p>
            </div>
            <div class="bg-slate-50/80 rounded-lg p-3 space-y-1 border border-slate-100">
              <p class="text-[11px] text-slate-500">2. เงินก้อน</p>
              <p class="text-[11.5px] text-slate-900">
                รวมทั้งหมด: <span id="totalSpending" class="mono font-semibold">–</span>
              </p>
              <p class="text-[10px] text-slate-400">ตั้งแต่เกษียณถึงสิ้นอายุ</p>
            </div>
            <div class="bg-slate-50/80 rounded-lg p-3 space-y-1 border border-slate-100">
              <p class="text-[11px] text-slate-500">3. ส่วนต่างที่ลดได้</p>
              <p class="text-[11.5px] text-emerald-600">
                ลดต่อปี: <span id="saveDiff" class="mono font-semibold">–</span>
              </p>
              <p class="text-[10px] text-slate-400">ยิ่งเริ่มเร็ว ยิ่งลดได้เยอะ</p>
            </div>
          </div>
        </div>

      </section>
    </div>
  </main>

  <script>
    const el = id => document.getElementById(id);
    const currentAgeEl = el('currentAge');
    const retireAgeEl = el('retireAge');
    const lifeAgeEl = el('lifeAge');
    const needPerMonthEl = el('needPerMonth');
    const inflationEl = el('inflation');
    const inflationLabel = el('inflationLabel');
    const returnRateEl = el('returnRate');
    const returnLabel = el('returnLabel');
    const calcBtn = el('calcBtn');

    function formatMoney(num){
      if(isNaN(num)) return '–';
      return new Intl.NumberFormat('th-TH',{maximumFractionDigits:0}).format(Math.round(num)) + ' บาท';
    }
    function formatMoney2(num){
      if(isNaN(num)) return '–';
      return new Intl.NumberFormat('th-TH',{maximumFractionDigits:2}).format(num) + ' บาท';
    }

    function calc(){
      const currentAge = parseFloat(currentAgeEl.value);
      const retireAge = parseFloat(retireAgeEl.value);
      const lifeAge = parseFloat(lifeAgeEl.value);
      const needNowPerMonth = parseFloat(needPerMonthEl.value);
      const infl = parseFloat(inflationEl.value) / 100;
      const retRate = parseFloat(returnRateEl.value) / 100;

      const yearsToRetire = Math.max(retireAge - currentAge, 0);
      const yearsAfterRetire = Math.max(lifeAge - retireAge, 0);
      el('summaryRetireAge').textContent = retireAge + ' ปี';

      // เงินใช้ต่อเดือนตอนเกษียณ (คิดเงินเฟ้อ)
      const futureMonthly = needNowPerMonth * Math.pow(1 + infl, yearsToRetire);
      const futureYearly = futureMonthly * 12;

      // เงินก้อนที่ต้องมี
      const lumpSum = futureMonthly * 12 * yearsAfterRetire;

      // ระยะเวลาออม
      const monthsToSave = Math.max(yearsToRetire * 12, 1);
      const savePerMonthNoInv = lumpSum / monthsToSave;
      const savePerYearNoInv = savePerMonthNoInv * 12;

      // แบบลงทุน
      let savePerMonthInv;
      if(retRate > 0){
        const r = retRate / 12;
        const factor = (Math.pow(1 + r, monthsToSave) - 1) / r;
        savePerMonthInv = lumpSum / factor;
      }else{
        savePerMonthInv = savePerMonthNoInv;
      }
      const savePerYearInv = savePerMonthInv * 12;
      const diffPerMonth = savePerMonthNoInv - savePerMonthInv;

      // แสดงผล
      el('needLumpSum').textContent = formatMoney(lumpSum);
      el('savePerMonthNoInv').textContent = formatMoney(savePerMonthNoInv);
      el('savePerMonthInv').textContent = formatMoney(savePerMonthInv);
      el('yearsToSaveLabel').textContent = 'ตลอด ' + yearsToRetire + ' ปี (' + monthsToSave + ' เดือน)';
      el('invCompareLabel').textContent = diffPerMonth > 0 ? 'ประหยัดได้ ' + formatMoney(diffPerMonth) + '/เดือน' : 'ผลตอบแทนยังไม่ช่วยมาก';
      el('futureMonthlyNeed').textContent = formatMoney2(futureMonthly);
      el('futureYearlyNeed').textContent = formatMoney(futureYearly);
      el('totalSpending').textContent = formatMoney(lumpSum);
      el('sumSaveNoInv').textContent = formatMoney(savePerYearNoInv);
      el('sumSaveInv').textContent = formatMoney(savePerYearInv);
      el('saveDiff').textContent = formatMoney(diffPerMonth * 12);
      el('lastCalcTime').textContent = 'คำนวณล่าสุด: ' + new Date().toLocaleString('th-TH');
    }

    function handleCalcClick(){
      if(calcBtn.classList.contains('is-loading')) return;
      calcBtn.classList.add('is-loading');
      const old = calcBtn.querySelector('.btn-text').textContent;
      calcBtn.innerHTML = `<div class="spinner"></div><span>กำลังคำนวณ...</span>`;
      calc();
      setTimeout(()=>{
        calcBtn.classList.remove('is-loading');
        calcBtn.innerHTML = `<span class="btn-text">${old}</span>`;
      }, 350);
    }

    inflationEl.addEventListener('input', e => {
      inflationLabel.textContent = parseFloat(e.target.value).toFixed(1) + '%';
      calc();
    });
    returnRateEl.addEventListener('input', e => {
      returnLabel.textContent = parseFloat(e.target.value).toFixed(1) + '%';
      calc();
    });

    document.getElementById('btnDemo').addEventListener('click', () => {
      currentAgeEl.value = 32;
      retireAgeEl.value = 58;
      lifeAgeEl.value = 85;
      needPerMonthEl.value = 42000;
      inflationEl.value = 2.6;
      inflationLabel.textContent = '2.6%';
      returnRateEl.value = 6.0;
      returnLabel.textContent = '6.0%';
      calc();
    });

    calcBtn.addEventListener('click', handleCalcClick);

    // auto adjust inflation
    function autoAdjustInflation(){
      const yearsToRetire = Math.max(parseFloat(retireAgeEl.value) - parseFloat(currentAgeEl.value), 0);
      if(yearsToRetire >= 25){
        const cur = parseFloat(inflationEl.value);
        const adj = Math.min(cur + 0.4, 3.5);
        inflationEl.value = adj;
        inflationLabel.textContent = adj.toFixed(1) + '%';
      }
      calc();
    }
    currentAgeEl.addEventListener('change', autoAdjustInflation);
    retireAgeEl.addEventListener('change', autoAdjustInflation);

    // first
    calc();
  </script>
</body>
</html>
